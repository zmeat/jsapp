<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>库存明细</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css"/>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/aui.2.0.css">
    <style>
    	#wrap{
            display: flex;
            display: -webkit-flex;
            display: -moz-flex;
            display: -ms-flex;
            display: -o-flex;
            flex-direction: column;
            -webkit-flex-direction:  column;
            -ms-flex-direction:  column;
            -o-flex-direction:  column;
            -moz-flex-direction:  column;
        }
    	#content{
    		width: 100%;
    		flex: 1;
    		-webkit-flex: 1;
    		-ms-flex: 1;
    		-moz-flex: 1;
    		-o-flex: 1;
            display: flex;
            display: -webkit-flex;
            display: -moz-flex;
            display: -ms-flex;
            display: -o-flex;
            flex-direction: column;
            -webkit-flex-direction:  column;
            -ms-flex-direction:  column;
            -o-flex-direction:  column;
            -moz-flex-direction:  column;
    	}
		.aui-list-item {
			height: 35px;
			min-height: 35px !important;
		}
		#form{
			flex: 1;
			width: 100%;
			background: #fff;
			position: relative;
		}
		table {
			white-space: nowrap;
			text-align: center;
		}
		table th{
			background: rgba(0,0,0,0.1);
		}
		table th,td{
			border-right:1px solid #ccc;
			border-bottom:1px solid #ccc;
		}
		table th,td{
			padding: 2px;
			min-height: 20px;
			min-width: 130px;
			max-height: 25px;
			max-width: 150px;
			overflow: hidden;
			text-overflow: ellipsis;

		}
    </style>
</head>
<body>
<div id="wrap">
    <header class="aui-bar aui-bar-nav">
        <a class="aui-pull-left aui-btn" tapmode onclick="closeWin('warehouse_detail')">
            <span class="aui-iconfont aui-icon-left"></span>
        </a>
        <div class="aui-title">库存明细</div>
        <a class="aui-pull-right aui-btn" tapmode onclick="openWin('warehouse_filter','./warehouse_filter.html')">
            <span class="aui-iconfont">筛选</span>
        </a>
    </header>
	<div id="content">
		<div class="aui-content aui-margin-b-15 show-selection">
		    <ul class="aui-list aui-form-list">
		        <li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    日期
		                </div>
		                <input type="text" placeholder="2016-09-14至2016-09-16" name="time" disabled>
		            </div>
		        </li>
		        <li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    条码：
		                </div>
		                <div class="aui-list-item-input">
		                    <input type="text" placeholder="不限" name="tiaoma" disabled="disabled">
		                </div>
		            </div>
		        </li>
		        <li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    料件编号：
		                </div>
		                <div class="aui-list-item-input">
		                    <input type="text" placeholder="不限" name="bianhao" disabled="disabled">
		                </div>
		            </div>
		        </li>
		        <li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    品名：
		                </div>
		                <div class="aui-list-item-input">
		                    <input type="text" placeholder="不限" name="pinming" disabled="disabled">
		                </div>
		            </div>
		        </li>
		       	<li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    规格：
		                </div>
		                <div class="aui-list-item-input">
		                    <input type="text" placeholder="不限" name="guige" disabled="disabled">
		                </div>
		            </div>
		        </li>
		        <li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    仓库：
		                </div>
		                <div class="aui-list-item-input">
		                    <input type="text" placeholder="不限" name="warehouse" disabled="disabled">
		                </div>
		            </div>
		        </li>
		        <li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    库位：
		                </div>
		                <div class="aui-list-item-input">
		                    <input type="text" placeholder="不限" name="kuwei" disabled="disabled">
		                </div>
		            </div>
		        </li>
		        <li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    批号：
		                </div>
		                <div class="aui-list-item-input">
		                    <input type="text" placeholder="不限" name="pihao" disabled="disabled">
		                </div>
		            </div>
		        </li>
		        <li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    单位：
		                </div>
		                <div class="aui-list-item-input">
		                    <input type="text" placeholder="不限" name="danwei" disabled="disabled">
		                </div>
		            </div>
		        </li>
		        <li class="aui-list-item">
		            <div class="aui-list-item-inner">
		                <div class="aui-list-item-label">
		                    单据编号：
		                </div>
		                <div class="aui-list-item-input">
		                    <input type="text" placeholder="不限" name="danjubianhao" disabled="disabled">
		                </div>
		            </div>
		        </li>
		    </ul>
		</div>

		<!-- form -->	
		<div id="form" onclick="showMenu()">
			<div id="menu" style="width:100%;height: 45px; background: #a9b7b7; position: absolute; top:0;" hidden>
		        <a class="aui-pull-right" onclick="requestFull(this)">
		            <span><img width="32" height="32" src="../image/full.png" style="position: absolute; right: 15px; top: 50%; margin-top: -16px"></span>
		        </a>
			</div>
			<div style="overflow: scroll">
				<table>
					<tr>
	                    <th>单据日期</th>
	                    <th>单据编号</th>
	                    <th>人员</th>
	                    <th>仓库</th>
	                    <th>库位</th>
	                    <th>批号</th>
	                    <th>部门</th>
	                    <th>计量单位</th>
	                    <th>备注</th>
					</tr>
					<tr>
	                    <td>2016-10-01</td>
	                    <td>a44</td>
	                    <td>往事如烟</td>
	                    <td>A7</td>
	                    <td>A44</td>
	                    <td>z12454878</td>
	                    <td>策划部</td>
	                    <td>吨</td>
	                    <td>这是一段备注描述可以在场一点再长一点</td>
					</tr>
					<tr>
	                    <td>2016-10-01</td>
	                    <td>a44</td>
	                    <td>往事如烟</td>
	                    <td>A7</td>
	                    <td>A44</td>
	                    <td>z12454878</td>
	                    <td>策划部</td>
	                    <td>吨</td>
	                    <td>这是一段备注描述可以在场一点再长一点</td>
					</tr>
					<tr>
	                    <td>2016-10-01</td>
	                    <td>a44</td>
	                    <td>往事如烟</td>
	                    <td>A7</td>
	                    <td>A44</td>
	                    <td>z12454878</td>
	                    <td>策划部</td>
	                    <td>吨</td>
	                    <td>这是一段备注描述可以在场一点再长一点</td>
					</tr>
					<tr>
	                    <td>2016-10-01</td>
	                    <td>a44</td>
	                    <td>往事如烟</td>
	                    <td>A7</td>
	                    <td>A44</td>
	                    <td>z12454878</td>
	                    <td>策划部</td>
	                    <td>吨</td>
	                    <td>这是一段备注描述可以在场一点再长一点</td>
					</tr>
				</table>
			</div>
		</div>
	</div>

</div>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/zepto.min.js"></script>
<script type="text/javascript" src="../script/touch.js"></script>
<script type="text/javascript" src="../script/common.js"></script>
<script type="text/javascript">
var isFull = false; //记录是否有全屏的对象
	isShow = false;

apiready = function () {
    $api.fixStatusBar( $api.dom('header') );
    api.setStatusBarStyle({
        style: 'dark',
        color: "#33475f"
    });   

    //监听返回键
    api.addEventListener({
    	name: 'keyback'
	}, function(ret, err){
	    if( ret ){
	        if(isFull){
	        	api.setScreenOrientation({
				    orientation: 'portrait_up'
				});
				api.setFullScreen({
				    fullScreen: false
				});

				new fullScreen().out();
				isFull = false;
				$(that).find('img').attr('src', '../image/full.png');
	        }else{
	        	api.openWin();
	        }
	    }else{
	         alert( JSON.stringify( err ) );
	    }
	});

	//监听筛选条件
	api.addEventListener({
	    name: 'filter_save'
	}, function(ret, err) {
	    if (ret) {
	     	for(var key in ret.value){
	     		if(key !== 'time1' && key !== 'time2'){
	     			$('input[name='+key+']').val(ret.value[key]);
	     		}else{
	     			$('input[name=time]').val(ret.value['time1']+'至'+ret.value['time2']);
	     		}
	     	}
	    } else {
	        alert(JSON.stringify(err));
	    }
	});

}

$(function(){
	needEdit('#form');
});

function requestFull(that){
	var el = document.getElementById("form");

	if(!isFull){//全屏
		api.setScreenOrientation({
		    orientation: 'landscape_left'
		});
		api.setFullScreen({
		    fullScreen: true
		});

		new fullScreen(el).in();
		isFull = true;

		$(that).find('img').attr('src', '../image/cancel_full.png');
	}else{//取消全屏
    	api.setScreenOrientation({
		    orientation: 'portrait_up'
		});
		api.setFullScreen({
		    fullScreen: false
		});

		new fullScreen().out();
		isFull = false;

		$(that).find('img').attr('src', '../image/full.png');
	}

}



function needEdit(el){
	$(el).find('tr').each(function(key, val){
		if(key === 0){
			$(this).append('<th>操作</th>')
		}else{
			$(this).append("<td><span style=\"padding:2px;color:#e51c23;\" onclick=\"remove(this, event)\">删除</span></td>")
		}
	});
}

function showMenu(){
	if(isShow){
		isShow = false;
		$('#menu').attr('hidden', 'hidden');
	}else{
		isShow = true;

		setTimeout(function(){
			$('#menu').removeAttr('hidden');		
		},100);
	}

}

function remove(that, e){
	e.preventDefault();
	e.stopPropagation();

	api.confirm({
	    title: '',
	    msg: '确定要删除改行数据吗？',
	    buttons: ['确定', '取消']
	}, function(ret, err){
	    if( ret ){
	        if(ret.buttonIndex === 1){
	         	$(that).closest('tr').remove();
	        }
	    }else{
	         alert( JSON.stringify( err ) );
	    }
	});
}

function edit(that, e){
	e.preventDefault();
	e.stopPropagation();

	openWin('addtion_goods', '../html/addtion_goods.html');
}
</script>
</html>